/*
 * jQuery Plugin: Highlight Search Terms - version 0.2
 * http://github.com/hail2u/jquery.highlight-search-terms
 * Highlight search terms in referrer URL from Google, Yahoo!, Bing and custom site.
 *
 * Copyright (c) 2009 Kyo Nagashima <kyo@hail2u.net>
 * This library licensed under MIT license:
 * http://opensource.org/licenses/mit-license.php
 */
(function(b){b.fn.highlightSearchTerms=function(d){var h=b.extend({},b.fn.highlightSearchTerms.defaults,d);b.merge(h.referrerPatterns,b.fn.highlightSearchTerms.builtinReferrerPatterns);var g=h.referrer||document.referrer;if(g){var f=c(g,h);if(f!==""){f=new RegExp("("+f+")","gi");var e='<em class="'+a(h.className)+'">$1</em>';this.find(":not(iframe, option, script, textarea)").contents().each(function(){if(this.nodeType===3){var i=a(this.nodeValue).replace(f,e);b(this).replaceWith(i)}})}}return this};function c(e,f){var d="";b.each(f.referrerPatterns,function(){var h=new RegExp(this,"i");if(h.exec(e)){var g=new RegExp(f.unsafeChars,"g");d=decodeURIComponent(RegExp.$1).replace(g,"+").replace(/^\+*(.*?)\+*$/,"$1").replace(/\++/g,"|");return false}});return d}function a(d){return b("<u/>").text(d).html()}b.fn.highlightSearchTerms.defaults={className:"highlight",referrerPatterns:[],unsafeChars:"[!-*,-/:-@[-`{-~]"};b.fn.highlightSearchTerms.builtinReferrerPatterns=["^http://www.google.com.+[&?]q=([^&]+).*$","^http://www.google.co.jp.+[&?]q=([^&]+).*$","^http://search.yahoo.com.+[&?]p=([^&]+).*$","^http://search.yahoo.co.jp.+[&?]p=([^&]+).*$","^http://www.bing.com.+[&?]q=([^&]+).*$"]})(jQuery);