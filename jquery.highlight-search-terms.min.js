/*
 jQuery Plugin: Highlight Search Terms - version 0.3
 http://github.com/hail2u/jquery.highlight-search-terms
 Highlight search terms in referrer URL from Google, Yahoo!, Bing and custom site.

 Copyright (c) 2009 Kyo Nagashima <kyo@hail2u.net>
 This library licensed under MIT license:
 http://opensource.org/licenses/mit-license.php
*/
(function(b){function g(a,c){var d="";b.each(c.referrerPatterns,function(){if(RegExp(this,"i").exec(a)){var e=RegExp(c.unsafeChars,"g");d=decodeURIComponent(RegExp.$1).replace(e,"+").replace(/^\+*(.*?)\+*$/,"$1").replace(/\++/g,"|");return false}});return d}function f(a){return b("<u/>").text(a).html()}b.fn.highlightSearchTerms=function(a){a=b.extend({},b.fn.highlightSearchTerms.defaults,a);b.merge(a.referrerPatterns,b.fn.highlightSearchTerms.builtinReferrerPatterns);var c=a.referrer||document.referrer;
if(c){var d=g(c,a);if(d!==""){d=RegExp("("+d+")","gi");c=f(a.tagName);a=f(a.className);var e="<"+c+' class="'+a+'">$1</'+c+">";this.find(":not(iframe, option, script, textarea)").contents().each(function(){if(this.nodeType===3){var h=f(this.nodeValue).replace(d,e);b(this).replaceWith(h)}})}}return this};b.fn.highlightSearchTerms.defaults={tagName:"em",className:"highlight",referrerPatterns:[],unsafeChars:"[!-*,-/:-@[-`{-~]"};b.fn.highlightSearchTerms.builtinReferrerPatterns=["^http://www.google.com.+[&?]q=([^&]+).*$",
"^http://www.google.co.jp.+[&?]q=([^&]+).*$","^http://search.yahoo.com.+[&?]p=([^&]+).*$","^http://search.yahoo.co.jp.+[&?]p=([^&]+).*$","^http://www.bing.com.+[&?]q=([^&]+).*$"]})(jQuery);